<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:core="clr-namespace:KOTORModSync.Core;assembly=KOTORModSync.Core"
             xmlns:converters="clr-namespace:KOTORModSync.Converters"
             x:Class="KOTORModSync.Controls.ModListItem"
             x:DataType="core:Component">

    <UserControl.Resources>
        <converters:DownloadStatusConverter x:Key="DownloadStatusConverter" />
        <converters:DownloadTooltipConverter x:Key="DownloadTooltipConverter" />
        <converters:StringNotEmptyConverter x:Key="StringNotEmptyConverter" />
    </UserControl.Resources>

    <Border x:Name="RootBorder"
            Padding="8,6"
            Margin="2,1"
            BorderThickness="1"
            CornerRadius="4"
            Classes="mod-list-item">

        <Grid ColumnDefinitions="Auto,Auto,Auto,*,Auto,Auto,Auto">

            <!-- Checkbox -->
            <CheckBox Grid.Column="0"
                      x:Name="ComponentCheckBox"
                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                      VerticalAlignment="Center"
                      Margin="0,0,8,0"
                      Tag="{Binding}"
                      ToolTip.Tip="Select this mod for installation" />

            <!-- Index Number (Editor Mode Only) -->
            <TextBlock Grid.Column="1"
                       x:Name="IndexTextBlock"
                       VerticalAlignment="Center"
                       FontWeight="Bold"
                       FontSize="12"
                       Classes="secondary-text"
                       Margin="0,0,8,0"
                       IsVisible="False" />

            <!-- Download Status Icon -->
            <TextBlock Grid.Column="2"
                       Text="{Binding IsDownloaded, Converter={StaticResource DownloadStatusConverter}}"
                       VerticalAlignment="Center"
                       FontSize="16"
                       Margin="0,0,8,0"
                       ToolTip.Tip="{Binding IsDownloaded, Converter={StaticResource DownloadTooltipConverter}}" />

            <!-- Mod Name and Category -->
            <StackPanel Grid.Column="3" VerticalAlignment="Center" Spacing="4">
                <TextBlock Text="{Binding Name}"
                           FontSize="14"
                           FontWeight="SemiBold"
                           TextWrapping="NoWrap"
                           TextTrimming="CharacterEllipsis" />

                <!-- Category Badge (if available) -->
                <StackPanel Orientation="Horizontal" Spacing="6" x:Name="BadgePanel">
                    <Border x:Name="CategoryBadge"
                            CornerRadius="3"
                            Padding="6,2"
                            Classes="mod-list-item-badge category-badge"
                            IsVisible="{Binding Category, Converter={StaticResource StringNotEmptyConverter}}">
                        <TextBlock Text="{Binding Category}"
                                   FontSize="10"
                                   FontWeight="Medium" />
                    </Border>

                    <Border x:Name="TierBadge"
                            CornerRadius="3"
                            Padding="6,2"
                            Classes="mod-list-item-badge tier-badge"
                            IsVisible="{Binding Tier, Converter={StaticResource StringNotEmptyConverter}}">
                        <TextBlock Text="{Binding Tier}"
                                   FontSize="10"
                                   FontWeight="Medium" />
                    </Border>
                </StackPanel>
            </StackPanel>

            <!-- Validation Status Icon -->
            <TextBlock Grid.Column="5"
                       x:Name="ValidationIcon"
                       VerticalAlignment="Center"
                       FontSize="14"
                       Margin="0,0,8,0"
                       IsVisible="False" />

            <!-- Drag Handle (Editor Mode Only) -->
            <TextBlock Grid.Column="6"
                       x:Name="DragHandle"
                       Text="⋮⋮"
                       VerticalAlignment="Center"
                       FontSize="16"
                       FontWeight="Bold"
                       Classes="mod-list-item-drag-handle"
                       Cursor="Hand"
                       ToolTip.Tip="Drag to reorder"
                       IsVisible="False" />
        </Grid>
    </Border>
</UserControl>


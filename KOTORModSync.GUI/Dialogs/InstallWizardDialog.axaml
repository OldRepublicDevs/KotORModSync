<!--  Copyright 2021-2025 KOTORModSync  -->
<!--  Licensed under the Business Source License 1.1 (BSL 1.1).  -->
<!--  See LICENSE.txt file in the project root for full license information.  -->
<Window
    x:Class="KOTORModSync.Dialogs.InstallWizardDialog"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:KOTORModSync.Converters"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="KOTORModSync Installation Wizard"
    Width="900"
    Height="650"
    MinWidth="800"
    MinHeight="600"
    Background="Transparent"
    ExtendClientAreaChromeHints="NoChrome"
    ExtendClientAreaTitleBarHeightHint="-1"
    ExtendClientAreaToDecorationsHint="True"
    SystemDecorations="BorderOnly"
    WindowStartupLocation="CenterOwner"
    mc:Ignorable="d">

    <Window.Styles>
        <!--  Style for navigation buttons in sidebar  -->
        <Style Selector="Button.wizard-nav-item">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="Button.wizard-nav-item:pointerover">
            <Setter Property="Opacity" Value="0.85" />
        </Style>
        <Style Selector="Button.wizard-nav-item:disabled">
            <Setter Property="Opacity" Value="0.4" />
            <Setter Property="Cursor" Value="Default" />
        </Style>
    </Window.Styles>

    <Panel>
        <!--  Custom Window Controls  -->
        <StackPanel
            Margin="0,8,8,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Orientation="Horizontal"
            Spacing="0"
            ZIndex="999">
            <Button
                Width="40"
                Height="40"
                HorizontalContentAlignment="Center"
                Click="MinimizeButton_Click"
                Content="-"
                FontSize="15" />
            <Button
                Width="40"
                Height="40"
                HorizontalContentAlignment="Center"
                Click="CloseButton_Click"
                Content="X"
                FontSize="15" />
        </StackPanel>

        <Border
            Margin="16"
            Padding="0"
            CornerRadius="8">
            <Grid ColumnDefinitions="240,*">
                <!--  Left Sidebar: Table of Contents  -->
                <Border
                    Grid.Column="0"
                    Padding="16"
                    BorderThickness="0,0,1,0"
                    CornerRadius="8,0,0,8">
                    <StackPanel Spacing="8">
                        <TextBlock
                            FontSize="12"
                            FontWeight="Bold"
                            Opacity="0.7"
                            Text="INSTALLATION STEPS" />
                        <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                            <ItemsControl x:Name="PageNavigationList" Margin="0,8,0,0">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button
                                            Margin="0,2"
                                            Padding="12,10"
                                            HorizontalAlignment="Stretch"
                                            HorizontalContentAlignment="Left"
                                            Classes="wizard-nav-item"
                                            Click="NavigationItem_Click"
                                            CommandParameter="{Binding PageIndex}"
                                            IsEnabled="{Binding IsAccessible}"
                                            Tag="{Binding}">
                                            <Grid ColumnDefinitions="Auto,*,Auto">
                                                <!--  Checkmark for completed pages  -->
                                                <TextBlock
                                                    Grid.Column="0"
                                                    Margin="0,0,8,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="12"
                                                    IsVisible="{Binding IsCompleted}"
                                                    Text="✓" />
                                                <!--  Page number for incomplete pages  -->
                                                <TextBlock
                                                    Grid.Column="0"
                                                    Margin="0,0,8,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    IsVisible="{Binding !IsCompleted}"
                                                    Opacity="0.6"
                                                    Text="{Binding PageIndex, StringFormat={}{0}.}" />
                                                <!--  Page title  -->
                                                <TextBlock
                                                    Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    FontSize="13"
                                                    FontWeight="{Binding IsCurrent, Converter={x:Static local:BoolToFontWeightConverter.Instance}}"
                                                    Text="{Binding DisplayTitle}"
                                                    TextTrimming="CharacterEllipsis"
                                                    TextWrapping="NoWrap" />
                                                <!--  Current indicator  -->
                                                <Border
                                                    Grid.Column="2"
                                                    Width="4"
                                                    Height="20"
                                                    Margin="8,0,0,0"
                                                    CornerRadius="2"
                                                    IsVisible="{Binding IsCurrent}" />
                                            </Grid>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </StackPanel>
                </Border>

                <!--  Right Side: Main Content  -->
                <Grid Grid.Column="1" RowDefinitions="Auto,*,Auto">
                    <!--  Header with progress indicator  -->
                    <Border
                        Grid.Row="0"
                        Padding="24,16"
                        CornerRadius="0,8,0,0">
                        <Grid ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Column="0" Spacing="8">
                                <TextBlock
                                    x:Name="PageTitleText"
                                    FontSize="24"
                                    FontWeight="Bold"
                                    Text="Welcome" />
                                <TextBlock
                                    x:Name="PageSubtitleText"
                                    FontSize="14"
                                    Opacity="0.7"
                                    Text="Welcome to the KOTORModSync Installation Wizard" />
                            </StackPanel>
                            <StackPanel
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                Spacing="4">
                                <TextBlock
                                    x:Name="ProgressStepText"
                                    HorizontalAlignment="Right"
                                    FontSize="12"
                                    Opacity="0.7"
                                    Text="Step 1 of 15" />
                                <ProgressBar
                                    x:Name="WizardProgress"
                                    Width="200"
                                    Height="6"
                                    Maximum="15"
                                    Minimum="0"
                                    Value="1" />
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!--  Content area with page transition  -->
                    <Border Grid.Row="1" Padding="24,16">
                        <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                            <ContentControl x:Name="PageContent" />
                        </ScrollViewer>
                    </Border>

                    <!--  Navigation buttons  -->
                    <Border
                        Grid.Row="2"
                        Padding="24,16"
                        CornerRadius="0,0,8,0">
                        <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                            <Button
                                x:Name="CancelButton"
                                Grid.Column="0"
                                MinWidth="100"
                                Padding="12,8"
                                Click="CancelButton_Click"
                                Content="Cancel" />

                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal"
                                Spacing="8">
                                <TextBlock
                                    x:Name="StatusText"
                                    VerticalAlignment="Center"
                                    FontSize="12"
                                    Opacity="0.7" />
                                <ProgressBar
                                    x:Name="StatusProgress"
                                    Width="200"
                                    Height="4"
                                    IsIndeterminate="True"
                                    IsVisible="False" />
                            </StackPanel>

                            <Button
                                x:Name="BackButton"
                                Grid.Column="2"
                                MinWidth="100"
                                Margin="0,0,8,0"
                                Padding="12,8"
                                Click="BackButton_Click"
                                Content="← Back" />
                            <Button
                                x:Name="NextButton"
                                Grid.Column="3"
                                MinWidth="100"
                                Margin="0,0,8,0"
                                Padding="12,8"
                                Click="NextButton_Click"
                                Content="Next →" />
                            <Button
                                x:Name="FinishButton"
                                Grid.Column="4"
                                MinWidth="100"
                                Padding="12,8"
                                Click="FinishButton_Click"
                                Content="Finish"
                                IsVisible="False" />
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Border>
    </Panel>
</Window>

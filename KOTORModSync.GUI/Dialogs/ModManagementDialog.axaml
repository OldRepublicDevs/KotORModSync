<!--  Copyright 2021-2025 KOTORModSync  -->
<!--  Licensed under the Business Source License 1.1 (BSL 1.1).  -->
<!--  See LICENSE.txt file in the project root for full license information.  -->
<Window
    x:Class="KOTORModSync.Dialogs.ModManagementDialog"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Mod Management Tools"
    Width="800"
    Height="600"
    MinWidth="600"
    MinHeight="400"
    ExtendClientAreaChromeHints="NoChrome"
    ExtendClientAreaTitleBarHeightHint="-1"
    ExtendClientAreaToDecorationsHint="True"
    SystemDecorations="BorderOnly"
    WindowStartupLocation="CenterOwner">

    <Window.Styles>
        <!-- <StyleInclude Source="/Styles/KotorStyle.axaml" /> -->
    </Window.Styles>

    <Grid RowDefinitions="Auto,*,Auto">
        <!--  Custom Window Controls  -->
        <StackPanel
            Grid.Row="0"
            Margin="0,8,8,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Orientation="Horizontal"
            Spacing="0">
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="MinimizeButton_Click"
                Content="-"
                FontSize="15" />
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="ToggleMaximizeButton_Click"
                Content="â–¢"
                FontSize="15" />
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="CloseButton_Click"
                Content="X"
                FontSize="15" />
        </StackPanel>
        <!--  Header  -->
        <Border
            Grid.Row="0"
            Padding="10"
            Background="{DynamicResource ThemeBorderBrush}">
            <TextBlock
                FontSize="18"
                FontWeight="Bold"
                Foreground="{DynamicResource ThemeForegroundBrush}"
                Text="Mod Management Tools" />
        </Border>

        <!--  Main Content  -->
        <TabControl Grid.Row="1" Margin="10">
            <!--  Batch Operations Tab  -->
            <TabItem Header="Batch Operations">
                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10" Spacing="20">
                        <TextBlock
                            FontSize="16"
                            FontWeight="Bold"
                            Text="Batch Operations" />

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Selection Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="SelectAllMods_Click" Content="Select All Mods" />
                                <Button Click="DeselectAllMods_Click" Content="Deselect All Mods" />
                                <Button Click="InvertSelection_Click" Content="Invert Selection" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Validation Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="ValidateAllMods_Click" Content="Validate All Mods" />
                                <Button Click="CheckFileAvailability_Click" Content="Check File Availability" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Sorting Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="SortByName_Click" Content="Sort by Name (A-Z)" />
                                <Button Click="SortByNameDesc_Click" Content="Sort by Name (Z-A)" />
                                <Button Click="SortByAuthor_Click" Content="Sort by Author" />
                                <Button Click="SortByCategory_Click" Content="Sort by Category" />
                                <Button Click="SortByTier_Click" Content="Sort by Tier" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Metadata Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="SetAllDownloaded_Click" Content="Set All to Downloaded" />
                                <Button Click="SetAllNotDownloaded_Click" Content="Set All to Not Downloaded" />
                                <Button Click="UpdateCategories_Click" Content="Update Categories" />
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!--  Import/Export Tab  -->
            <TabItem Header="Import/Export">
                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10" Spacing="20">
                        <TextBlock
                            FontSize="16"
                            FontWeight="Bold"
                            Text="Import and Export Operations" />

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Import Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="ImportFromToml_Click" Content="Import from TOML File" />
                                <Button Click="ImportFromJson_Click" Content="Import from JSON" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Export Operations"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="ExportToToml_Click" Content="Export to TOML File" />
                                <Button Click="ExportToJson_Click" Content="Export to JSON" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Merge Strategies"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <RadioButton
                                    Content="Replace existing components"
                                    GroupName="MergeStrategy"
                                    IsChecked="True" />
                                <RadioButton Content="Merge by GUID" GroupName="MergeStrategy" />
                                <RadioButton Content="Merge by Name/Author" GroupName="MergeStrategy" />
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!--  Statistics Tab  -->
            <TabItem Header="Statistics">
                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10" Spacing="20">
                        <TextBlock
                            FontSize="16"
                            FontWeight="Bold"
                            Text="Mod Collection Statistics" />

                        <Grid
                            ColumnDefinitions="*,*"
                            DataContext="{Binding .}"
                            RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto">
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                FontWeight="Bold"
                                Text="Total Mods:" />
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="1"
                                Text="{Binding TotalMods}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                FontWeight="Bold"
                                Text="Selected Mods:" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="1"
                                Text="{Binding SelectedMods}" />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                FontWeight="Bold"
                                Text="Downloaded Mods:" />
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="1"
                                Text="{Binding DownloadedMods}" />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                FontWeight="Bold"
                                Text="Average Instructions/Mod:" />
                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="1"
                                Text="{Binding AverageInstructionsPerMod, StringFormat=F1}" />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                FontWeight="Bold"
                                Text="Average Options/Mod:" />
                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="1"
                                Text="{Binding AverageOptionsPerMod, StringFormat=F1}" />
                        </Grid>

                        <TextBlock
                            Margin="0,20,0,10"
                            FontWeight="Bold"
                            Text="Categories:" />
                        <ItemsRepeater ItemsSource="{Binding Category}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock>
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}: {1}">
                                                <Binding Path="Key" />
                                                <Binding Path="Value" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>

                        <TextBlock
                            Margin="0,20,0,10"
                            FontWeight="Bold"
                            Text="Tiers:" />
                        <ItemsRepeater ItemsSource="{Binding Tiers}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock>
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}: {1}">
                                                <Binding Path="Key" />
                                                <Binding Path="Value" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>

                        <TextBlock
                            Margin="0,20,0,10"
                            FontWeight="Bold"
                            Text="Authors:" />
                        <ItemsRepeater ItemsSource="{Binding Authors}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock>
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}: {1}">
                                                <Binding Path="Key" />
                                                <Binding Path="Value" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!--  Advanced Tools Tab  -->
            <TabItem Header="Advanced Tools">
                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10" Spacing="20">
                        <TextBlock
                            FontSize="16"
                            FontWeight="Bold"
                            Text="Advanced Mod Management Tools" />

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Dependency Management"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="CheckDependencyChains_Click" Content="Check Dependency Chains" />
                                <Button Click="ResolveConflicts_Click" Content="Resolve Conflicts" />
                                <Button Click="GenerateDependencyGraph_Click" Content="Generate Dependency Graph" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Performance Tools"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="OptimizeInstallationOrder_Click" Content="Optimize Installation Order" />
                                <Button Click="AnalyzeModSizes_Click" Content="Analyze Mod Sizes" />
                                <Button Click="CheckRedundantFiles_Click" Content="Check for Redundant Files" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Security Tools"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="ScanForMalware_Click" Content="Scan for Malware" />
                                <Button Click="CheckFileIntegrity_Click" Content="Check File Integrity" />
                                <Button Click="ValidateDigitalSignatures_Click" Content="Validate Digital Signatures" />
                            </StackPanel>
                        </Expander>

                        <Expander
                            HorizontalAlignment="Stretch"
                            Header="Maintenance Tools"
                            IsExpanded="True">
                            <StackPanel Spacing="10">
                                <Button Click="CleanOrphanedFiles_Click" Content="Clean Orphaned Files" />
                                <Button Click="UpdateModLinks_Click" Content="Update Mod Links" />
                                <Button Click="ArchiveOldVersions_Click" Content="Archive Old Versions" />
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!--  Footer  -->
        <Border
            Grid.Row="2"
            Padding="10"
            Background="{DynamicResource ThemeBorderBrush}">
            <StackPanel
                HorizontalAlignment="Right"
                Orientation="Horizontal"
                Spacing="10">
                <Button Click="ApplyChanges_Click" Content="Apply Changes" />
                <Button Click="Cancel_Click" Content="Cancel" />
            </StackPanel>
        </Border>
    </Grid>
</Window>

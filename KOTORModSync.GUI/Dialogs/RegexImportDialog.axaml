<!-- Copyright 2021-2025 KOTORModSync -->
<!-- Licensed under the Business Source License 1.1 (BSL 1.1). -->
<!-- See LICENSE.txt file in the project root for full license information. -->
<Window
    x:Class="KOTORModSync.Dialogs.RegexImportDialog"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Markdown Import - Regex Profile"
    Width="1200"
    Height="800"
    ExtendClientAreaChromeHints="NoChrome"
    ExtendClientAreaTitleBarHeightHint="-1"
    ExtendClientAreaToDecorationsHint="True"
    SystemDecorations="BorderOnly">
    <Grid ColumnDefinitions="*,*" RowDefinitions="*,Auto">
        <!--  Custom Window Controls  -->
        <StackPanel
            Grid.Row="0"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="0,8,8,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Orientation="Horizontal"
            Spacing="0">
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="MinimizeButton_Click"
                Content="-"
                FontSize="15" />
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="ToggleMaximizeButton_Click"
                Content="â–¢"
                FontSize="15" />
            <Button
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="CloseButton_Click"
                Content="X"
                FontSize="15" />
        </StackPanel>

        <!--  Left Panel: Tabs and Controls  -->
        <StackPanel
            Grid.Row="0"
            Grid.Column="0"
            Margin="16"
            Orientation="Vertical">
            <TextBlock
                x:Name="DescriptionTextBlock"
                Margin="0,0,0,8"
                Text="Configure regex patterns and preview match counts." />

            <!--  Tab Control for Raw and Simple  -->
            <TabControl
                Name="MainTabControl"
                Height="400"
                Margin="0,0,0,16"
                SelectedIndex="{Binding SelectedTabIndex, Mode=TwoWay}">
                <TabItem Name="SimpleTab" Header="Simple">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid
                            Margin="8"
                            ColumnDefinitions="Auto,*"
                            RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto">
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="ModComponent Section (Outer)" />
                            <TextBox
                                Name="ComponentSectionTextBox"
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.ComponentSectionPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Heading Pattern" />
                            <TextBox
                                Name="HeadingTextBox"
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.HeadingPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Name Pattern" />
                            <TextBox
                                Name="NameTextBox"
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.NamePattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Author Pattern" />
                            <TextBox
                                Name="AuthorTextBox"
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.AuthorPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Description Pattern" />
                            <TextBox
                                Name="DescriptionTextBox"
                                Grid.Row="4"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.DescriptionPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="5"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Masters Pattern" />
                            <TextBox
                                Name="MastersTextBox"
                                Grid.Row="5"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.DependenciesPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="6"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Category &amp; Tier Pattern" />
                            <TextBox
                                Name="CategoryTextBox"
                                Grid.Row="6"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.CategoryTierPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="7"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Non-English Pattern" />
                            <TextBox
                                Name="NonEnglishTextBox"
                                Grid.Row="7"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.NonEnglishPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="8"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Install Method Pattern" />
                            <TextBox
                                Name="InstallationMethodTextBox"
                                Grid.Row="8"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.InstallationMethodPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="9"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Install Instructions Pattern" />
                            <TextBox
                                Name="InstallationInstructionsTextBox"
                                Grid.Row="9"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.InstallationInstructionsPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="10"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="ModLink Pattern" />
                            <TextBox
                                Name="ModLinkTextBox"
                                Grid.Row="10"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                Text="{Binding Profile.ModLinkPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown" />

                            <TextBlock
                                Grid.Row="11"
                                Grid.Column="0"
                                Margin="0,0,8,4"
                                VerticalAlignment="Center"
                                Text="Preview: Components / Links" />
                            <TextBlock
                                Grid.Row="11"
                                Grid.Column="1"
                                Margin="0,0,0,4"
                                FontWeight="Bold"
                                Text="{Binding PreviewSummary}" />
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <TabItem Name="RawTab" Header="Raw">
                    <Grid Margin="8" RowDefinitions="Auto,Auto,*">
                        <TextBlock
                            x:Name="RawTitleTextBlock"
                            Grid.Row="0"
                            Margin="0,0,0,8"
                            Text="Complete Regex Pattern (Advanced)" />

                        <!--  Regex Flags  -->
                        <StackPanel
                            Grid.Row="1"
                            Margin="0,0,0,8"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,8,0"
                                VerticalAlignment="Center"
                                Text="Flags:" />
                            <CheckBox
                                Margin="0,0,12,0"
                                Content="Global (g)"
                                IsChecked="{Binding Profile.GlobalFlag, Mode=TwoWay}" />
                            <CheckBox
                                Margin="0,0,12,0"
                                Content="Multiline (m)"
                                IsChecked="{Binding Profile.MultilineFlag, Mode=TwoWay}" />
                            <CheckBox
                                Margin="0,0,12,0"
                                Content="Ignore Case (i)"
                                IsChecked="{Binding Profile.IgnoreCaseFlag, Mode=TwoWay}" />
                            <CheckBox Content="Singleline (s)" IsChecked="{Binding Profile.SinglelineFlag, Mode=TwoWay}" />
                        </StackPanel>

                        <ScrollViewer
                            Grid.Row="2"
                            HorizontalScrollBarVisibility="Auto"
                            VerticalScrollBarVisibility="Auto">
                            <TextBox
                                x:Name="RawRegexTextBox"
                                AcceptsReturn="True"
                                Text="{Binding Profile.RawRegexPattern}"
                                LostFocus="OnRegexPatternChanged"
                                KeyDown="OnRegexTextBox_KeyDown"
                                TextWrapping="Wrap" />
                        </ScrollViewer>
                    </Grid>
                </TabItem>
            </TabControl>

            <!--  Action Buttons  -->
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <Button
                    Margin="0,0,8,0"
                    Click="OnResetDefaults"
                    Content="Reset Defaults" />
                <Button
                    Margin="0,0,8,0"
                    Click="OnCancel"
                    Content="Cancel" />
                <Button Click="OnLoad" Content="Load" />
            </StackPanel>
        </StackPanel>

        <!--  Right Panel: Preview Area  -->
        <Border
            Grid.Row="0"
            Grid.Column="1"
            Margin="8"
            BorderThickness="1">
            <Grid RowDefinitions="Auto,*">
                <TextBlock
                    x:Name="PreviewTitleTextBlock"
                    Grid.Row="0"
                    Margin="8,8,8,4"
                    Text="Live Preview" />
                <TextBox
                    Name="PreviewTextBox"
                    Grid.Row="1"
                    Margin="8"
                    AcceptsReturn="True"
                    AcceptsTab="True"
                    TextWrapping="Wrap"
                    FontFamily="Consolas,Monaco,monospace"
                    IsReadOnly="False"
                    Text="{Binding PreviewMarkdown, Mode=TwoWay}"
                    KeyDown="OnPreviewTextBox_KeyDown" />
            </Grid>
        </Border>

    </Grid>
</Window>

<Window
    x:Class="KOTORModSync.Dialogs.ValidationDialog"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Validation Results"
    Width="700"
    Height="600"
    MinWidth="600"
    MinHeight="400"
    ExtendClientAreaChromeHints="NoChrome"
    ExtendClientAreaTitleBarHeightHint="-1"
    ExtendClientAreaToDecorationsHint="True"
    SystemDecorations="BorderOnly"
    WindowStartupLocation="CenterOwner">

    <Window.Styles>
        <StyleInclude Source="/Styles/KotorStyle.axaml" />
    </Window.Styles>

    <Grid RowDefinitions="Auto,*,Auto">
        <!--  Title Bar  -->
        <Grid Grid.Row="0" Background="{DynamicResource ThemeBackgroundBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Grid.Column="0"
                Margin="16,12"
                VerticalAlignment="Center"
                FontSize="18"
                FontWeight="Bold"
                Text="Validation Results" />
            <Button
                Grid.Column="1"
                Width="40"
                Height="40"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Click="CloseButton_Click"
                Content="X"
                FontSize="15" />
        </Grid>

        <!--  Content  -->
        <ScrollViewer
            Grid.Row="1"
            Padding="16"
            VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="16">
                <!--  Success/Failure Summary  -->
                <Border
                    x:Name="SummaryBorder"
                    Padding="16"
                    Classes="summary-card"
                    CornerRadius="8">
                    <StackPanel Spacing="8">
                        <TextBlock
                            x:Name="SummaryIcon"
                            HorizontalAlignment="Center"
                            FontSize="32"
                            Text="âœ…" />
                        <TextBlock
                            x:Name="SummaryText"
                            HorizontalAlignment="Center"
                            FontSize="18"
                            FontWeight="Bold"
                            Text="Validation Successful!" />
                        <TextBlock
                            x:Name="SummaryDetails"
                            HorizontalAlignment="Center"
                            Classes="secondary-text"
                            Text=""
                            TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!--  Issues Section  -->
                <StackPanel
                    x:Name="IssuesPanel"
                    IsVisible="False"
                    Spacing="12">
                    <TextBlock
                        FontSize="16"
                        FontWeight="Bold"
                        Text="Issues Found" />

                    <!--  System Issues  -->
                    <StackPanel
                        x:Name="SystemIssuesPanel"
                        IsVisible="False"
                        Spacing="8">
                        <TextBlock
                            FontSize="14"
                            FontWeight="SemiBold"
                            Text="âš™ï¸ System Issues" />
                        <ItemsControl x:Name="SystemIssuesList" />
                    </StackPanel>

                    <!--  Mod-Specific Issues  -->
                    <StackPanel
                        x:Name="ModIssuesPanel"
                        IsVisible="False"
                        Spacing="8">
                        <TextBlock
                            FontSize="14"
                            FontWeight="SemiBold"
                            Text="ðŸ“¦ Mod-Specific Issues" />
                        <ItemsControl x:Name="ModIssuesList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Margin="0,4"
                                        Padding="12"
                                        Classes="summary-card"
                                        CornerRadius="6">
                                        <StackPanel Spacing="8">
                                            <Grid ColumnDefinitions="Auto,*">
                                                <TextBlock
                                                    Grid.Column="0"
                                                    Margin="0,0,8,0"
                                                    VerticalAlignment="Top"
                                                    FontSize="20"
                                                    DataContext="{Binding .}"
                                                    Text="{Binding Icon}" />
                                                <StackPanel Grid.Column="1" Spacing="4">
                                                    <TextBlock
                                                        DataContext="{Binding .}"
                                                        FontSize="14"
                                                        FontWeight="Bold"
                                                        Text="{Binding ModName}" />
                                                    <TextBlock
                                                        DataContext="{Binding .}"
                                                        Classes="secondary-text"
                                                        FontSize="12"
                                                        Text="{Binding IssueType}" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        DataContext="{Binding .}"
                                                        Text="{Binding Description}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        FontStyle="Italic"
                                                        Foreground="{DynamicResource Validation.SolutionBrush}"
                                                        IsVisible="{Binding HasSolution}"
                                                        DataContext="{Binding .}"
                                                        Text="{Binding Solution}"
                                                        TextWrapping="Wrap" />
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!--  Buttons  -->
        <Border
            Grid.Row="2"
            Padding="16"
            Background="{DynamicResource ThemeBackgroundBrush}"
            BorderBrush="{DynamicResource ThemeBorderMidBrush}"
            BorderThickness="0,1,0,0">
            <StackPanel
                HorizontalAlignment="Right"
                Orientation="Horizontal"
                Spacing="8">
                <Button
                    x:Name="OpenOutputButton"
                    Click="OpenOutput_Click"
                    Content="ðŸ“Š View Detailed Logs"
                    IsVisible="False" />
                <Button
                    x:Name="OkButton"
                    MinWidth="80"
                    Click="Ok_Click"
                    Content="OK"
                    IsDefault="True" />
            </StackPanel>
        </Border>
    </Grid>
</Window>
